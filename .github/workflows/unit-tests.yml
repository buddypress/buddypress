name: Unit Tests

on:
  pull_request:
    paths-ignore:
      - 'docs/**'
  push:
    branches: [ master ]
    paths-ignore:
      - 'docs/**'

jobs:
  tests:
    strategy:
      fail-fast: false
      matrix:
        php: ['7.4', '8.0', '8.1', '8.2', '8.3']
        wordpress: ['latest']
        multisite: [true, false]
        object: ["memcached", "redis"]
        dependencies: ["lowest", "highest"]
        include:
          - php: '8.0'
            wordpress: '6.4'
          - php: '7.4'
            wordpress: '6.4'
          - php: '7.4'
            wordpress: '6.1'
    uses: alleyinteractive/.github/.github/workflows/php-tests.yml@main
    name: "WP: ${{ matrix.wordpress }} - PHP: ${{ matrix.php }}"
    with:
      dependency-versions: ${{ matrix.dependencies }}
      multisite: ${{ matrix.multisite }}
      php: ${{ matrix.php }}
      wordpress: ${{ matrix.wordpress }}
      object-cache: ${{ matrix.object }}
